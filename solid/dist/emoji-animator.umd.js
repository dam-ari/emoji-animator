(function(I,E){typeof exports=="object"&&typeof module<"u"?module.exports=E():typeof define=="function"&&define.amd?define(E):(I=typeof globalThis<"u"?globalThis:I||self).EmojiAnimator=E()})(this,function(){"use strict";const I={equals:(t,o)=>t===o};let E=X;const j=1,k=2,nt={owned:null,cleanups:null,context:null,owner:null};var w=null;let st,G=null,v=null,y=null,T=null,q=0;function J(t,o){const e={value:t,observers:null,observerSlots:null,comparator:(o=o?Object.assign({},I,o):I).equals||void 0};return[it.bind(e),r=>(typeof r=="function"&&(r=r(e.value)),V(e,r))]}function L(t,o,e){M(W(t,o,!1,j))}function lt(t,o,e){E=ut;const r=W(t,o,!1,j),n=st;e&&e.render||(r.user=!0),T?T.push(r):M(r)}function R(t){if(v===null)return t();const o=v;v=null;try{return t()}finally{v=o}}function it(){if(this.sources&&this.state)if(this.state===j)M(this);else{const t=y;y=null,F(()=>H(this),!1),y=t}if(v){const t=this.observers?this.observers.length:0;v.sources?(v.sources.push(this),v.sourceSlots.push(t)):(v.sources=[this],v.sourceSlots=[t]),this.observers?(this.observers.push(v),this.observerSlots.push(v.sources.length-1)):(this.observers=[v],this.observerSlots=[v.sources.length-1])}return this.value}function V(t,o,e){let r=t.value;return t.comparator&&t.comparator(r,o)||(t.value=o,t.observers&&t.observers.length&&F(()=>{for(let n=0;n<t.observers.length;n+=1){const s=t.observers[n],i=G&&G.running;i&&G.disposed.has(s),(i?s.tState:s.state)||(s.pure?y.push(s):T.push(s),s.observers&&Y(s)),i||(s.state=j)}if(y.length>1e6)throw y=[],new Error},!1)),o}function M(t){if(!t.fn)return;K(t);const o=q;(function(e,r,n){let s;const i=w,l=v;v=w=e;try{s=e.fn(r)}catch(u){return e.pure&&(e.state=j,e.owned&&e.owned.forEach(K),e.owned=null),e.updatedAt=n+1,Z(u)}finally{v=l,w=i}(!e.updatedAt||e.updatedAt<=n)&&(e.updatedAt!=null&&"observers"in e?V(e,s):e.value=s,e.updatedAt=n)})(t,t.value,o)}function W(t,o,e,r=j,n){const s={fn:t,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:o,owner:w,context:w?w.context:null,pure:e};return w===null||w!==nt&&(w.owned?w.owned.push(s):w.owned=[s]),s}function P(t){if(t.state===0)return;if(t.state===k)return H(t);if(t.suspense&&R(t.suspense.inFallback))return t.suspense.effects.push(t);const o=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<q);)t.state&&o.push(t);for(let e=o.length-1;e>=0;e--)if((t=o[e]).state===j)M(t);else if(t.state===k){const r=y;y=null,F(()=>H(t,o[0]),!1),y=r}}function F(t,o){if(y)return t();let e=!1;o||(y=[]),T?e=!0:T=[],q++;try{const r=t();return function(n){if(y&&(X(y),y=null),n)return;const s=T;T=null,s.length&&F(()=>E(s),!1)}(e),r}catch(r){e||(T=null),y=null,Z(r)}}function X(t){for(let o=0;o<t.length;o++)P(t[o])}function ut(t){let o,e=0;for(o=0;o<t.length;o++){const r=t[o];r.user?t[e++]=r:P(r)}for(o=0;o<e;o++)P(t[o])}function H(t,o){t.state=0;for(let e=0;e<t.sources.length;e+=1){const r=t.sources[e];if(r.sources){const n=r.state;n===j?r!==o&&(!r.updatedAt||r.updatedAt<q)&&P(r):n===k&&H(r,o)}}}function Y(t){for(let o=0;o<t.observers.length;o+=1){const e=t.observers[o];e.state||(e.state=k,e.pure?y.push(e):T.push(e),e.observers&&Y(e))}}function K(t){let o;if(t.sources)for(;t.sources.length;){const e=t.sources.pop(),r=t.sourceSlots.pop(),n=e.observers;if(n&&n.length){const s=n.pop(),i=e.observerSlots.pop();r<n.length&&(s.sourceSlots[i]=r,n[r]=s,e.observerSlots[r]=i)}}if(t.owned){for(o=t.owned.length-1;o>=0;o--)K(t.owned[o]);t.owned=null}if(t.cleanups){for(o=t.cleanups.length-1;o>=0;o--)t.cleanups[o]();t.cleanups=null}t.state=0}function Z(t,o=w){throw function(r){return r instanceof Error?r:new Error(typeof r=="string"?r:"Unknown error",{cause:r})}(t)}function ft(t,o,e){let r;const n=()=>{const i=document.createElement("template");return i.innerHTML=t,e?i.content.firstChild.firstChild:i.content.firstChild},s=o?()=>R(()=>document.importNode(r||(r=n()),!0)):()=>(r||(r=n())).cloneNode(!0);return s.cloneNode=s,s}function _(t,o){o==null?t.removeAttribute("class"):t.className=o}function O(t,o,e,r,n){for(;typeof e=="function";)e=e();if(o===e)return e;const s=typeof o,i=r!==void 0;if(t=i&&e[0]&&e[0].parentNode||t,s==="string"||s==="number")if(s==="number"&&(o=o.toString()),i){let l=e[0];l&&l.nodeType===3?l.data!==o&&(l.data=o):l=document.createTextNode(o),e=B(t,e,r,l)}else e=e!==""&&typeof e=="string"?t.firstChild.data=o:t.textContent=o;else if(o==null||s==="boolean")e=B(t,e,r);else{if(s==="function")return L(()=>{let l=o();for(;typeof l=="function";)l=l();e=O(t,l,e,r)}),()=>e;if(Array.isArray(o)){const l=[],u=e&&Array.isArray(e);if(Q(l,o,e,n))return L(()=>e=O(t,l,e,r,!0)),()=>e;if(l.length===0){if(e=B(t,e,r),i)return e}else u?e.length===0?tt(t,l,r):function(b,a,h){let U=h.length,S=a.length,m=U,d=0,c=0,z=a[S-1].nextSibling,f=null;for(;d<S||c<m;)if(a[d]!==h[c]){for(;a[S-1]===h[m-1];)S--,m--;if(S===d){const p=m<U?c?h[c-1].nextSibling:h[m-c]:z;for(;c<m;)b.insertBefore(h[c++],p)}else if(m===c)for(;d<S;)f&&f.has(a[d])||a[d].remove(),d++;else if(a[d]===h[m-1]&&h[c]===a[S-1]){const p=a[--S].nextSibling;b.insertBefore(h[c++],a[d++].nextSibling),b.insertBefore(h[--m],p),a[S]=h[m]}else{if(!f){f=new Map;let g=c;for(;g<m;)f.set(h[g],g++)}const p=f.get(a[d]);if(p!=null)if(c<p&&p<m){let g,C=d,A=1;for(;++C<S&&C<m&&(g=f.get(a[C]))!=null&&g===p+A;)A++;if(A>p-c){const x=a[d];for(;c<p;)b.insertBefore(h[c++],x)}else b.replaceChild(h[c++],a[d++])}else d++;else a[d++].remove()}}else d++,c++}(t,e,l):(e&&B(t),tt(t,l));e=l}else if(o.nodeType){if(Array.isArray(e)){if(i)return e=B(t,e,r,o);B(t,e,null,o)}else e!=null&&e!==""&&t.firstChild?t.replaceChild(o,t.firstChild):t.appendChild(o);e=o}}return e}function Q(t,o,e,r){let n=!1;for(let s=0,i=o.length;s<i;s++){let l,u=o[s],b=e&&e[t.length];if(!(u==null||u===!0||u===!1))if((l=typeof u)=="object"&&u.nodeType)t.push(u);else if(Array.isArray(u))n=Q(t,u,b)||n;else if(l==="function")if(r){for(;typeof u=="function";)u=u();n=Q(t,Array.isArray(u)?u:[u],Array.isArray(b)?b:[b])||n}else t.push(u),n=!0;else{const a=String(u);b&&b.nodeType===3&&b.data===a?t.push(b):t.push(document.createTextNode(a))}}return n}function tt(t,o,e=null){for(let r=0,n=o.length;r<n;r++)t.insertBefore(o[r],e)}function B(t,o,e,r){if(e===void 0)return t.textContent="";const n=r||document.createTextNode("");if(o.length){let s=!1;for(let i=o.length-1;i>=0;i--){const l=o[i];if(n!==l){const u=l.parentNode===t;s||i?u&&l.remove():u?t.replaceChild(n,l):t.insertBefore(n,e)}else s=!0}}else t.insertBefore(n,e);return[n]}var ct=ft("<div><span>");return t=>{const{emojis:o=[],duration:e=5e3,onAnimationEnd:r,size:n="2em",fadeIn:s=!1,reverseLoop:i=!1,class:l,style:u}=t,[b,a]=J(o[0]||""),[h,U]=J(o),[S,m]=J(!1);let d;return lt(()=>{clearInterval(d),console.log("Initializing EmojiAnimator with emojis:",o),U(o);let f=0,p=1;return d=setInterval(()=>{const g=h().length;g>0&&(f+=p,f!==g&&f!==-1||(i?(p*=-1,f+=2*p):f=0,f===g-1&&r&&r()),a(h()[f]),m(!0),setTimeout(()=>m(!1),500))},e/(h().length||1)),a(o[0]||""),()=>clearInterval(d)}),c=ct(),z=c.firstChild,_(c,`emoji-animator ${l||""}`),function(f,p,g,C){if(g===void 0||C||(C=[]),typeof p!="function")return O(f,p,C,g);L(A=>O(f,p(),A,g),C)}(z,b),L(f=>{var p={"font-size":n,...u},g=s&&S()?"fade-in":"";return f.e=function(C,A,x){if(!A)return x?function(et,ot,rt){rt==null?et.removeAttribute(ot):et.setAttribute(ot,rt)}(C,"style"):A;const $=C.style;if(typeof A=="string")return $.cssText=A;let D,N;for(N in typeof x=="string"&&($.cssText=x=void 0),x||(x={}),A||(A={}),x)A[N]==null&&$.removeProperty(N),delete x[N];for(N in A)D=A[N],D!==x[N]&&($.setProperty(N,D),x[N]=D);return x}(c,p,f.e),g!==f.t&&_(z,f.t=g),f},{e:void 0,t:void 0}),c;var c,z}});
